import{c as N,r as d,j as e,d as V,h as K,u as P,X as R,s as k,t as g}from"./index-BpY0WgHP.js";import{I as X}from"./input-BvL5Mogg.js";import{C as p,d as f}from"./index-BA7pfreJ.js";import{B as w}from"./button-A5Wi0IzG.js";import{C as G,F as j,L as H}from"./layout-DGSTY2PH.js";import{T as J}from"./trash-2-Bp2gZTWM.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=N("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=N("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=N("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=N("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=N("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),se=({onSearch:i})=>{const[l,o]=d.useState(""),a=()=>{i(l)};return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ee,{className:"text-gray-400",size:18})}),e.jsx(X,{type:"text",placeholder:"Search your notes...",value:l,onChange:n=>{o(n.target.value),i(n.target.value)},onKeyPress:n=>n.key==="Enter"&&a(),className:"pl-10"})]})},te=K("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function L({className:i,variant:l,...o}){return e.jsx("div",{className:V(te({variant:l}),i),...o})}const ae=({notes:i,onDeleteNote:l,onToggleTask:o})=>e.jsx("div",{className:"space-y-4",children:i.map(a=>e.jsx(p,{className:"overflow-hidden",children:e.jsx(f,{className:"p-0",children:e.jsxs("div",{className:"flex items-start p-4",children:[e.jsxs("div",{className:"flex items-center justify-center w-10 h-10 mr-3 rounded-full bg-gray-100",children:[a.type==="task"&&e.jsx(w,{variant:"ghost",size:"icon",onClick:()=>o&&o(a.id),className:"p-0 h-auto w-auto hover:bg-transparent",children:a.completed?e.jsx(O,{className:"text-green-500",size:20}):e.jsx(G,{className:"text-gray-400",size:20})}),a.type==="text"&&e.jsx(j,{className:"text-blue-500",size:20}),a.type==="link"&&e.jsx(Z,{className:"text-purple-500",size:20}),a.type==="image"&&e.jsx(Y,{className:"text-green-500",size:20})]}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("p",{className:`text-gray-800 ${a.type==="task"&&a.completed?"line-through text-gray-400":""}`,children:a.content}),a.tags&&a.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:a.tags.map((n,b)=>e.jsx(L,{variant:"outline",className:"text-xs",children:n},b))}),a.type==="image"&&a.imageUrl&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:a.imageUrl,alt:a.content,className:"max-h-64 rounded-md object-cover"})}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:a.createdAt.toLocaleString()})]}),e.jsxs(w,{variant:"ghost",size:"icon",onClick:()=>l(a.id),className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:[e.jsx(J,{size:18}),e.jsx("span",{className:"sr-only",children:"Delete"})]})]})})},a.id))}),de=()=>{const{user:i}=P(),[l,o]=d.useState([]),[a,n]=d.useState([]),[b,E]=d.useState(!0),[y,C]=d.useState(""),[h,S]=d.useState([]),[T,F]=d.useState([]),[m,z]=d.useState(null);d.useEffect(()=>{(async()=>{if(i)try{const{data:t,error:c}=await k.from("notes").select("*").order("created_at",{ascending:!1});if(c)throw c;const x=t.map(r=>({id:r.id,content:r.content,type:r.type,createdAt:new Date(r.created_at),completed:r.completed,imageUrl:r.image_url,tags:r.tags||[]}));o(x),n(x);const u=new Set;x.forEach(r=>{r.tags&&r.tags.forEach(M=>u.add(M))}),F(Array.from(u))}catch(t){g({variant:"destructive",title:"Error",description:"Failed to load notes: "+t.message})}finally{E(!1)}})()},[i]),d.useEffect(()=>{let s=l;y.trim()!==""&&(s=s.filter(t=>t.content.toLowerCase().includes(y.toLowerCase()))),h.length>0&&(s=s.filter(t=>t.tags&&h.some(c=>t.tags.includes(c)))),m&&(s=s.filter(t=>t.type===m)),n(s)},[y,h,m,l]);const A=async s=>{if(i)try{const{error:t}=await k.from("notes").delete().eq("id",s);if(t)throw t;const c=l.filter(x=>x.id!==s);o(c),n(c),g({title:"Success",description:"Note deleted successfully"})}catch(t){g({variant:"destructive",title:"Error",description:"Failed to delete note: "+t.message})}},q=async s=>{if(i)try{const t=l.find(r=>r.id===s&&r.type==="task");if(!t)return;const c=!t.completed,{error:x}=await k.from("notes").update({completed:c}).eq("id",s);if(x)throw x;const u=l.map(r=>r.id===s&&r.type==="task"?{...r,completed:c}:r);o(u),n(u),g({title:"Success",description:`Task marked as ${c?"completed":"incomplete"}`})}catch(t){g({variant:"destructive",title:"Error",description:"Failed to update task: "+t.message})}},I=s=>{C(s)},$=s=>{S(t=>t.includes(s)?t.filter(c=>c!==s):[...t,s])},v=s=>{z(t=>t===s?null:s)},B=()=>{C(""),S([]),z(null)},D=l.filter(s=>s.type==="text").length,Q=l.filter(s=>s.type==="task").length,U=l.filter(s=>s.type==="link").length,_=l.filter(s=>s.type==="image").length;return e.jsx(H,{children:e.jsxs("div",{className:"max-w-6xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"All Notes"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Browse and manage all your captured thoughts"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-4 mb-8",children:[e.jsx(p,{className:`cursor-pointer transition-all hover:shadow-md ${m==="text"?"bg-purple-50 border-purple-200":""}`,onClick:()=>v("text"),children:e.jsx(f,{className:"flex items-center justify-between p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-purple-100 p-2 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Text Notes"}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:[D," notes"]})]})]})})}),e.jsx(p,{className:`cursor-pointer transition-all hover:shadow-md ${m==="task"?"bg-green-50 border-green-200":""}`,onClick:()=>v("task"),children:e.jsx(f,{className:"flex items-center justify-between p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-100 p-2 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Tasks"}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:[Q," tasks"]})]})]})})}),e.jsx(p,{className:`cursor-pointer transition-all hover:shadow-md ${m==="link"?"bg-blue-50 border-blue-200":""}`,onClick:()=>v("link"),children:e.jsx(f,{className:"flex items-center justify-between p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Links"}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:[U," links"]})]})]})})}),e.jsx(p,{className:`cursor-pointer transition-all hover:shadow-md ${m==="image"?"bg-amber-50 border-amber-200":""}`,onClick:()=>v("image"),children:e.jsx(f,{className:"flex items-center justify-between p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-amber-100 p-2 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Images"}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:[_," images"]})]})]})})})]}),e.jsx("div",{className:"mb-6",children:e.jsx(se,{onSearch:I})}),T.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(W,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Filter by tags:"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[T.map(s=>e.jsx(L,{variant:h.includes(s)?"default":"outline",className:"cursor-pointer",onClick:()=>$(s),children:s},s)),(h.length>0||y||m)&&e.jsxs(w,{variant:"ghost",size:"sm",onClick:B,className:"text-xs flex items-center gap-1",children:[e.jsx(R,{size:14})," Clear filters"]})]})]}),b?e.jsx("div",{className:"flex justify-center my-12",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-purple-500 border-t-transparent rounded-full"})}):a.length>0?e.jsx(ae,{notes:a,onDeleteNote:A,onToggleTask:q}):e.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-600",children:"No notes found with the current filters."})})]})})};export{de as default};
